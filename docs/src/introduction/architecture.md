# Architecture

## System Components

The Privacy Pool protocol consists of three main layers:

1. **Zero-Knowledge Layer**: Contains the Circom circuits for generating and verifying zero-knowledge proofs. The key components are:

   - `CommitmentHasher` circuit
   - `LeanIMTInclusionProof` circuit
   - `Withdraw` circuit
     These circuits enable privacy-preserving transactions while maintaining the integrity of the system state.

2. **Contracts Layer**: Implements the core protocol logic and manages the state of the Privacy Pools. The main contracts are:

   - `Entrypoint`: Serves as the main entrypoint for user interactions and manages multiple APS-operated Privacy Pools.
   - `PrivacyPool`: Represents a pool for a specific asset type (ERC20 or native). Handles deposits, withdrawals, and ragequits.
   - Verifiers: Contracts for verifying the zero-knowledge proofs generated by the circuits.

3. **Association Set Provider (ASP)**: An off-chain service that approves valid withdrawal labels. The ASP maintains a merkle tree of approved labels, which is periodically updated on the Entrypoint contract.

### System Actors

The actors in the Privacy Pool system are:

1. **Users**: Interact with the protocol to deposit, withdraw, and ragequit assets. Users generate zero-knowledge proofs to maintain privacy.

2. **ASP Operators**: Approves valid withdrawal labels and updates the merkle root on the Entrypoint contract.
